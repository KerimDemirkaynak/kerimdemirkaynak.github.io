<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modern Anime Card Generator</title>
    
    <meta name="description" content="Create beautiful, shareable anime info cards instantly using AniList data. Free, fast, and mobile-friendly.">
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚ú®</text></svg>">

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&display=swap');

        :root {
            /* Light Theme - Modern Gradient Bg */
            --bg-gradient: linear-gradient(135deg, #f6f8fd 0%, #e9ecf5 100%);
            --text-primary: #1a1a1a;
            --text-secondary: #666666;
            --card-bg: #ffffff;
            --input-bg: #ffffff;
            --input-border: #e0e0e0;
            --accent-color: #4F46E5; /* Modern Indigo */
            --accent-hover: #4338ca;
            --shadow-soft: 0 20px 40px rgba(0,0,0,0.08);
            --shadow-card: 0 10px 30px rgba(0,0,0,0.05);
            --border-radius-lg: 16px;
            --border-radius-sm: 8px;
        }

        /* Dark Mode - Premium Dark */
        [data-theme="dark"] {
            --bg-gradient: linear-gradient(135deg, #121212 0%, #2a2a2a 100%);
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            --card-bg: #1E1E1E;
            --input-bg: #2a2a2a;
            --input-border: #333;
            --accent-color: #6366F1;
            --accent-hover: #4f46e5;
            --shadow-soft: 0 20px 40px rgba(0,0,0,0.3);
            --shadow-card: 0 10px 30px rgba(0,0,0,0.2);
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-gradient);
            color: var(--text-primary);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 30px 20px;
            margin: 0;
            min-height: 100vh;
            transition: background 0.3s, color 0.3s;
        }

        h1 { 
            margin-bottom: 30px; 
            text-align: center; 
            font-weight: 900; 
            letter-spacing: -0.5px;
        }

        /* √úst Bar (Ayarlar) */
        .settings-bar {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 15px;
            font-size: 14px;
            font-weight: 500;
        }
        
        .settings-link {
            cursor: pointer;
            color: var(--accent-color);
            padding: 5px 10px;
            border-radius: var(--border-radius-sm);
            background: rgba(255,255,255,0.5);
            transition: 0.2s;
        }
        [data-theme="dark"] .settings-link { background: rgba(0,0,0,0.2); }
        .settings-link:hover { background: var(--accent-color); color: white; }

        /* Kontrol Paneli */
        .controls {
            margin-bottom: 40px;
            display: flex;
            gap: 12px;
            width: 100%;
            max-width: 420px;
            background: var(--card-bg);
            padding: 10px;
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-soft);
        }

        input {
            padding: 12px 15px;
            border: 2px solid transparent;
            background-color: var(--input-bg);
            color: var(--text-primary);
            border-radius: var(--border-radius-sm);
            font-size: 16px;
            flex: 1;
            outline: none;
            transition: 0.2s;
            font-family: 'Inter', sans-serif;
        }
        input:focus { border-color: var(--accent-color); }

        button#search-btn {
            padding: 12px 24px;
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            font-weight: 700;
            font-size: 16px;
            transition: 0.2s;
            flex-shrink: 0;
        }

        button#search-btn:hover { background-color: var(--accent-hover); transform: translateY(-1px); }
        button:disabled { opacity: 0.7; cursor: not-allowed; }

        /* --- KART TASARIMI (MODERNƒ∞ZE EDƒ∞LDƒ∞) --- */
        .card-wrapper {
            /* Mobilde k√º√ß√ºltme efekti i√ßin wrapper */
            transform-origin: top center;
            transition: transform 0.3s;
            /* Kartƒ±n dƒ±≈üƒ±na ta≈üan modern g√∂lge */
            box-shadow: var(--shadow-soft);
            border-radius: var(--border-radius-lg);
        }

        #capture-area {
            width: 400px; /* Sabit geni≈ülik */
            background: var(--card-bg);
            color: var(--text-primary);
            border-radius: var(--border-radius-lg); /* Yuvarlak k√∂≈üeler */
            overflow: hidden; /* Resim ta≈ümasƒ±n */
            position: relative;
        }

        .anime-image-container {
            width: 100%;
            height: 350px;
            overflow: hidden;
            background: #ddd; /* Y√ºklenirken gri alan */
        }

        .anime-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center top;
            display: block;
            transition: transform 0.5s;
        }

        /* --- GRID SYSTEM (Bozuk Yazƒ± √á√∂z√ºm√º) --- */
        .info-container {
            padding: 24px;
            background: var(--card-bg);
            /* CSS Grid: Etiketler ve deƒüerler asla √ºst √ºste binmez */
            display: grid;
            grid-template-columns: max-content 1fr; /* ƒ∞lk s√ºtun yazƒ± kadar, ikinci s√ºtun kalanƒ± */
            column-gap: 12px;
            row-gap: 10px;
            align-items: baseline;
        }

        .anime-title {
            /* Ba≈ülƒ±k t√ºm geni≈üliƒüi kaplasƒ±n */
            grid-column: 1 / -1; 
            font-size: 28px;
            font-weight: 900;
            text-align: left; /* SOLA Hƒ∞ZALI */
            margin: 0 0 15px 0;
            line-height: 1.2;
            color: var(--text-primary);
            /* √áok uzun ba≈ülƒ±klarƒ± 2 satƒ±rda kes */
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        /* Etiketler (Sol taraf) */
        .meta-label {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Deƒüerler (Saƒü taraf) */
        .meta-value {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
             /* Uzun metinlerde ta≈ümayƒ± √∂nle */
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* Alt √áizgi (Sezon ve Puan) */
        .footer-row {
            grid-column: 1 / -1; /* T√ºm geni≈ülik */
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 2px solid var(--input-border); /* Modern ayra√ß */
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 14px;
            color: var(--text-secondary);
        }

        .score-box {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 22px;
            font-weight: 900;
            color: var(--text-primary);
        }

        .star-icon { color: #FFD700; /* Altƒ±n sarƒ±sƒ± yƒ±ldƒ±z */ font-size: 20px; }

        /* ƒ∞ndir Butonu */
        #download-btn {
            margin-top: 30px;
            padding: 15px 30px;
            background-color: #2ecc71;
            color: white;
            border: none;
            border-radius: var(--border-radius-sm);
            font-weight: 700;
            font-size: 18px;
            cursor: pointer;
            display: none; /* Ba≈ülangƒ±√ßta gizli */
            box-shadow: 0 10px 20px rgba(46, 204, 113, 0.3);
            transition: 0.2s;
            width: 100%;
            max-width: 400px;
        }
        #download-btn:hover { background-color: #27ae60; transform: translateY(-2px); }

        /* Responsive */
        @media (max-width: 450px) {
            .card-wrapper { transform: scale(0.85); margin-bottom: -50px; }
            .controls { flex-wrap: wrap; }
            input { width: 100%; }
            button#search-btn { width: 100%; }
        }
        @media (max-width: 370px) {
             .card-wrapper { transform: scale(0.75); margin-bottom: -80px; }
        }
    </style>
</head>
<body>

    <div class="settings-bar">
        <div class="settings-link" onclick="toggleLanguage()">
            <span id="lang-icon">üåê</span> <span id="lang-text">English</span>
        </div>
        <div class="settings-link" onclick="toggleTheme()">
            <span id="theme-icon">üåì</span> <span id="theme-text">Dark Mode</span>
        </div>
    </div>

    <h1 id="page-title">Modern Anime Cards</h1>

    <div class="controls">
        <input type="text" id="searchInput" placeholder="Enter anime name..." onkeydown="if(event.key === 'Enter') fetchAnime()">
        <button id="search-btn" onclick="fetchAnime()">Search</button>
    </div>

    <div class="card-wrapper">
        <div id="capture-area">
            <div class="anime-image-container">
                <img id="poster" class="anime-image" src="https://s4.anilist.co/file/anilistcdn/media/anime/cover/large/bx20-YJ1jM3d7N1A6.png" alt="Anime Placeholder">
            </div>
            
            <div class="info-container">
                <h1 id="title" class="anime-title">NARUTO</h1>
                
                <span class="meta-label" id="label-genre">Genre</span>
                <span class="meta-value" id="genres">Action, Adventure</span>
                
                <span class="meta-label" id="label-studio">Studio</span>
                <span class="meta-value" id="studio">Studio Pierrot</span>

                <div class="footer-row">
                    <span id="season">FALL 2002</span>
                    <div class="score-box">
                        <span class="star-icon">‚òÖ</span>
                        <span id="score">7.9/10</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <button id="download-btn" onclick="downloadCard()">Download High-Res Image</button>

    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

    <script>
        // --- 1. Dƒ∞L VE √áEVƒ∞Rƒ∞ VERƒ∞Sƒ∞ ---
        const dictionary = {
            en: {
                pageTitle: "Modern Anime Cards",
                placeholder: "Enter anime name (e.g. One Piece)...",
                searchBtn: "Search",
                downloadBtn: "Download High-Res Image",
                labelGenre: "Genre",
                labelStudio: "Studio",
                errorEmpty: "Please enter an anime name!",
                errorNotFound: "Anime not found! Try another name.",
                toggleLang: "T√ºrk√ße",
                toggleThemeDark: "Dark Mode",
                toggleThemeLight: "Light Mode",
                seasons: { WINTER: "WINTER", SPRING: "SPRING", SUMMER: "SUMMER", FALL: "FALL" }
            },
            tr: {
                pageTitle: "Modern Anime Kartlarƒ±",
                placeholder: "Anime adƒ± yazƒ±n (√ñrn: One Piece)...",
                searchBtn: "Ara",
                downloadBtn: "Y√ºksek √á√∂z√ºn√ºrl√ºkl√º ƒ∞ndir",
                labelGenre: "T√ºr",
                labelStudio: "St√ºdyo",
                errorEmpty: "L√ºtfen bir anime adƒ± girin!",
                errorNotFound: "Anime bulunamadƒ±! Ba≈üka bir isim deneyin.",
                toggleLang: "English",
                toggleThemeDark: "Karanlƒ±k Mod",
                toggleThemeLight: "Aydƒ±nlƒ±k Mod",
                seasons: { WINTER: "KI≈û", SPRING: "ƒ∞LKBAHAR", SUMMER: "YAZ", FALL: "SONBAHAR" }
            }
        };

        const genreMap = {
            'Action': 'Aksiyon', 'Adventure': 'Macera', 'Comedy': 'Komedi', 'Drama': 'Dram',
            'Ecchi': 'Ecchi', 'Fantasy': 'Fantastik', 'Horror': 'Korku', 'Mahou Shoujo': 'B√ºy√ºl√º Kƒ±z',
            'Mecha': 'Mecha', 'Music': 'M√ºzik', 'Mystery': 'Gizem', 'Psychological': 'Psikolojik',
            'Romance': 'Romantizm', 'Sci-Fi': 'Bilim Kurgu', 'Slice of Life': 'G√ºnl√ºk Ya≈üam',
            'Sports': 'Spor', 'Supernatural': 'Doƒüa√ºst√º', 'Thriller': 'Gerilim'
        };

        let currentLang = 'en';

        // --- 2. AYARLARI ALGILA VE UYGULA ---
        function detectSettings() {
            const browserLang = navigator.language || navigator.userLanguage; 
            if (browserLang.startsWith('tr')) { currentLang = 'tr'; document.documentElement.lang = "tr"; }
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.body.setAttribute('data-theme', 'dark');
            }
            applyLanguage();
        }

        function toggleLanguage() {
            currentLang = (currentLang === 'en') ? 'tr' : 'en';
            applyLanguage();
        }

        function toggleTheme() {
            const body = document.body;
            body.setAttribute('data-theme', body.getAttribute('data-theme') === 'dark' ? 'light' : 'dark');
            applyLanguage();
        }

        function applyLanguage() {
            const t = dictionary[currentLang];
            document.getElementById('page-title').innerText = t.pageTitle;
            document.getElementById('searchInput').placeholder = t.placeholder;
            document.getElementById('search-btn').innerText = t.searchBtn;
            document.getElementById('download-btn').innerText = t.downloadBtn;
            document.getElementById('label-genre').innerText = t.labelGenre;
            document.getElementById('label-studio').innerText = t.labelStudio;
            document.getElementById('lang-text').innerText = t.toggleLang;
            
            const isDark = document.body.getAttribute('data-theme') === 'dark';
            document.getElementById('theme-text').innerText = isDark ? t.toggleThemeLight : t.toggleThemeDark;
            document.getElementById('theme-icon').innerText = isDark ? '‚òÄÔ∏è' : 'üåì';
        }

        // --- 3. ANILIST API BAƒûLANTISI ---
        const query = `query ($search: String) { Media (search: $search, type: ANIME, sort: SEARCH_MATCH) { title { romaji english } coverImage { extraLarge large } genres averageScore season seasonYear studios(isMain: true) { nodes { name } } } }`;

        async function fetchAnime() {
            const searchInput = document.getElementById('searchInput');
            const searchBtn = document.getElementById('search-btn');
            const t = dictionary[currentLang];
            
            if (!searchInput.value) return alert(t.errorEmpty);

            searchBtn.disabled = true;
            searchBtn.innerText = "..."

            try {
                const response = await fetch('https://graphql.anilist.co', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' },
                    body: JSON.stringify({ query: query, variables: { search: searchInput.value } })
                });

                const data = await response.json();
                const anime = data.data.Media;

                if (!anime) { alert(t.errorNotFound); } else { updateCard(anime); }
            } catch (error) {
                console.error(error); alert("API Error / Hata olu≈ütu");
            } finally {
                searchBtn.disabled = false;
                searchBtn.innerText = t.searchBtn;
            }
        }

        function updateCard(anime) {
            const imgEl = document.getElementById('poster');
            imgEl.crossOrigin = "Anonymous"; // CORS i√ßin √∂nemli
            imgEl.src = anime.coverImage.extraLarge || anime.coverImage.large;

            // Ba≈ülƒ±k
            document.getElementById('title').innerText = anime.title.english || anime.title.romaji;

            // T√ºrler (√áevirili ve ilk 2'si)
            let genresList = anime.genres.slice(0, 2);
            if (currentLang === 'tr') {
                genresList = genresList.map(g => genreMap[g] || g);
            }
            document.getElementById('genres').innerText = genresList.join(', ');

            // St√ºdyo
            document.getElementById('studio').innerText = anime.studios.nodes[0]?.name || '-';

            // Sezon ve Yƒ±l
            const seasonRaw = anime.season || '';
            const seasonTranslated = dictionary[currentLang].seasons[seasonRaw] || seasonRaw;
            document.getElementById('season').innerText = `${seasonTranslated} ${anime.seasonYear || ''}`;

            // Puan
            const score = anime.averageScore ? (anime.averageScore / 10).toFixed(1) : 'N/A';
            document.getElementById('score').innerText = `${score}/10`;

            // ƒ∞ndir butonunu g√∂ster
            document.getElementById('download-btn').style.display = 'block';
            // Mobilde klavyeyi kapat
            document.getElementById('searchInput').blur(); 
        }

        // --- 4. GELƒ∞≈ûMƒ∞≈û ƒ∞NDƒ∞RME FONKSƒ∞YONU ---
        function downloadCard() {
            const element = document.getElementById('capture-area');
            const wrapper = document.querySelector('.card-wrapper');
            const dlBtn = document.getElementById('download-btn');
            const isDark = document.body.getAttribute('data-theme') === 'dark';

            // 1. Hazƒ±rlƒ±k: Butonu gizle, g√∂lgeyi ve yuvarlak k√∂≈üeleri kaldƒ±r (temiz √ßƒ±ktƒ± i√ßin)
            dlBtn.style.display = 'none';
            wrapper.style.transform = 'none'; // Scale'i sƒ±fƒ±rla ki tam boy √ßƒ±ksƒ±n
            wrapper.style.boxShadow = 'none';
            element.style.borderRadius = '0'; // Keskin k√∂≈üe garantisi

            // html2canvas ayarlarƒ±
            html2canvas(element, {
                useCORS: true,
                scale: 3, // √áok y√ºksek kalite (Retina benzeri)
                // Arka plan rengini temaya g√∂re zorla, yoksa ≈üeffaf √ßƒ±kabilir
                backgroundColor: isDark ? '#1E1E1E' : '#ffffff', 
                logging: false
            }).then(canvas => {
                // 2. ƒ∞ndirme i≈ülemi
                const link = document.createElement('a');
                const cleanTitle = document.getElementById('title').innerText.replace(/[^a-z0-9]/gi, '_').toLowerCase().substring(0, 30);
                link.download = `${cleanTitle}_card_HD.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();

                // 3. Temizlik: Eski haline getir
                dlBtn.style.display = 'block';
                wrapper.style.transform = ''; // CSS'teki responsive scale geri d√∂ns√ºn
                wrapper.style.boxShadow = '';
                element.style.borderRadius = '';
            });
        }

        // Ba≈ülangƒ±√ß
        detectSettings();

    </script>
</body>
</html>
